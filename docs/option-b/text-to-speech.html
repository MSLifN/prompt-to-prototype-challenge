<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Text to Speech Reader - Have text read aloud to you">
    <title>Text to Speech Reader</title>
    <style>
        /* ========================================
           TEXT TO SPEECH ACCESSIBILITY TOOL
           Customize with Copilot prompts like:
           - "Add more voice options"
           - "Add highlighting for current word"
           - "Add pause/resume functionality"
           ======================================== */
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --accent: #10b981;
            --accent-dark: #059669;
        }

        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #000;
            color: #fff;
            padding: 8px 16px;
            z-index: 100;
            text-decoration: none;
        }
        .skip-link:focus {
            top: 0;
        }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            font-size: 18px;
            line-height: 1.6;
            color: #333;
            background: #f0fdf4;
            min-height: 100vh;
        }

        header {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }

        header h1 {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        .panel {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .panel h2 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: #333;
        }

        /* Controls */
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .control-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .control-btn:focus {
            outline: 3px solid var(--accent);
            outline-offset: 2px;
        }

        .play-btn {
            background: var(--accent);
            color: white;
        }

        .play-btn:hover {
            background: var(--accent-dark);
        }

        .play-btn.playing {
            background: #ef4444;
        }

        .play-btn.playing:hover {
            background: #dc2626;
        }

        .play-btn.paused {
            background: #f59e0b;
        }

        .play-btn.paused:hover {
            background: #d97706;
        }

        .secondary-btn {
            background: #e5e7eb;
            color: #374151;
        }

        .secondary-btn:hover {
            background: #d1d5db;
        }

        .replay-btn {
            background: #e0f2fe;
            color: #0369a1;
        }

        .replay-btn:hover {
            background: #bae6fd;
        }

        .button-hint {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.5rem;
            margin-bottom: 0;
        }

        /* Settings */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .setting-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #374151;
        }

        .setting-group select,
        .setting-group input[type="range"] {
            width: 100%;
            padding: 0.5rem;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            font-size: 1rem;
        }

        .setting-group select:focus,
        .setting-group input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .value-display {
            text-align: right;
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }

        /* Text area */
        .text-input-area {
            width: 100%;
            min-height: 200px;
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            line-height: 1.6;
            resize: vertical;
        }

        .text-input-area:focus {
            outline: none;
            border-color: var(--accent);
        }

        /* Status */
        .status-bar {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background: #f3f4f6;
            border-radius: 8px;
            margin-top: 1rem;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #9ca3af;
        }

        .status-indicator.ready {
            background: var(--accent);
        }

        .status-indicator.speaking {
            background: #ef4444;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .status-text {
            flex: 1;
            font-size: 0.875rem;
            color: #6b7280;
        }

        /* Sample texts */
        .sample-texts {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .sample-btn {
            padding: 0.5rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 20px;
            background: white;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .sample-btn:hover {
            border-color: var(--accent);
            background: #f0fdf4;
        }

        .sample-btn:focus {
            outline: 3px solid var(--accent);
            outline-offset: 2px;
        }

        /* Info box */
        .info-box {
            background: #f0fdf4;
            border: 2px solid var(--accent);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .info-box h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: var(--accent-dark);
        }

        .info-box p {
            font-size: 0.9rem;
            color: #374151;
        }

        footer {
            text-align: center;
            padding: 2rem;
            color: #6b7280;
        }

        .error-message {
            background: #fef2f2;
            border: 2px solid #ef4444;
            color: #dc2626;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        /* Copilot Help Section */
        .copilot-section {
            background: linear-gradient(135deg, #1e3a5f 0%, #2d1b4e 100%);
            color: white;
            padding: 2rem;
            margin: 2rem auto;
            max-width: 800px;
            border-radius: 12px;
        }
        .copilot-section h2 {
            color: #fff;
            margin-bottom: 1rem;
            font-size: 1.25rem;
        }
        .copilot-section p {
            margin-bottom: 1rem;
            opacity: 0.9;
        }
        .copilot-section ol {
            margin: 1rem 0 1.5rem 1.5rem;
        }
        .copilot-section li {
            margin-bottom: 0.75rem;
        }
        .copilot-section .prompt-box {
            background: rgba(0,0,0,0.3);
            padding: 1rem;
            border-radius: 8px;
            margin: 0.5rem 0;
            font-family: monospace;
            font-size: 0.9rem;
            border-left: 3px solid #60a5fa;
        }
        .copilot-section kbd {
            background: rgba(255,255,255,0.2);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: system-ui;
            font-size: 0.85rem;
        }
        .copilot-section .step-box {
            background: rgba(0,0,0,0.2);
            padding: 1rem 1.25rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        .copilot-section .step-box h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: #60a5fa;
        }
        .copilot-section .step-box p {
            margin-bottom: 0.5rem;
        }
        .copilot-section .step-box code {
            display: block;
            background: rgba(0,0,0,0.3);
            padding: 0.75rem;
            border-radius: 4px;
            margin-top: 0.5rem;
            word-break: break-all;
        }
        .copilot-section .clone-box {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        .copilot-section .clone-url {
            flex: 1;
            background: rgba(0,0,0,0.3);
            padding: 0.75rem;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.85rem;
            word-break: break-all;
        }
        .copilot-section .copy-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 0.75rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            white-space: nowrap;
            transition: background 0.2s;
        }
        .copilot-section .copy-btn:hover {
            background: #2563eb;
        }
        .copilot-section .copy-btn:focus {
            outline: 2px solid #60a5fa;
            outline-offset: 2px;
        }
        .copilot-section .copy-btn.copied {
            background: #10b981;
        }

        /* Navigation */
        .template-nav {
            background: #1e293b;
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .template-nav a {
            color: #94a3b8;
            text-decoration: none;
            font-size: 0.875rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }
        .template-nav a:hover {
            color: #fff;
            background: #334155;
        }
        .template-nav a:focus {
            outline: 2px solid #60a5fa;
            outline-offset: 2px;
        }
        .template-nav .nav-label {
            color: #64748b;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .template-nav .current {
            color: #fff;
            background: #3b82f6;
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <nav class="template-nav" aria-label="Template navigation">
        <span class="nav-label">Templates:</span>
        <a href="text-customization.html">Text</a>
        <a href="high-contrast.html">Contrast</a>
        <a href="focus-navigation.html">Focus</a>
        <a href="text-to-speech.html" class="current" aria-current="page">Speech</a>
        <a href="simplified-interface.html">Simple</a>
    </nav>

    <header>
        <h1>üîä Text to Speech Reader</h1>
        <p>Have any text read aloud to you</p>
    </header>

    <main id="main-content" class="container">
        <!-- Error message for unsupported browsers -->
        <div id="error-message" class="error-message" style="display: none;">
            <strong>‚ö†Ô∏è Speech synthesis not supported</strong>
            <p>Your browser doesn't support text-to-speech. Try using Chrome, Edge, Firefox, or Safari.</p>
        </div>

        <!-- Controls -->
        <section class="panel" aria-labelledby="controls-heading">
            <h2 id="controls-heading">üéõÔ∏è Controls</h2>
            
            <div class="controls">
                <button class="control-btn play-btn" id="play-btn" aria-label="Play speech">
                    <span id="play-icon">‚ñ∂Ô∏è</span>
                    <span id="play-text">Play</span>
                </button>
                <button class="control-btn replay-btn" id="replay-btn" aria-label="Replay from beginning" style="display: none;">
                    üîÑ Replay
                </button>
            </div>
            <p class="button-hint" id="button-hint">Press Play to start reading</p>

            <div class="settings-grid">
                <div class="setting-group">
                    <label for="voice-select">Voice</label>
                    <select id="voice-select">
                        <option value="">Loading voices...</option>
                    </select>
                </div>

                <div class="setting-group">
                    <label for="rate-slider">Speed</label>
                    <input type="range" id="rate-slider" min="0.5" max="2" step="0.1" value="1">
                    <div class="value-display" id="rate-value">1.0x</div>
                </div>

                <div class="setting-group">
                    <label for="pitch-slider">Pitch</label>
                    <input type="range" id="pitch-slider" min="0.5" max="2" step="0.1" value="1">
                    <div class="value-display" id="pitch-value">1.0</div>
                </div>
            </div>

            <div class="status-bar">
                <div class="status-indicator" id="status-indicator"></div>
                <span class="status-text" id="status-text">Ready</span>
            </div>
        </section>

        <!-- Text Input -->
        <section class="panel" aria-labelledby="text-heading">
            <h2 id="text-heading">üìù Text to Read</h2>
            
            <p style="margin-bottom: 0.5rem;">Quick samples:</p>
            <div class="sample-texts" style="margin-bottom: 1rem;">
                <button class="sample-btn" data-text="Welcome to the text to speech reader. This tool can read any text aloud to help you consume content in a different way.">Welcome message</button>
                <button class="sample-btn" data-text="The quick brown fox jumps over the lazy dog. This sentence contains every letter of the alphabet.">Pangram</button>
                <button class="sample-btn" data-text="Accessibility is about ensuring everyone can use technology effectively. Screen readers, text-to-speech, and other assistive technologies help make the digital world more inclusive.">About accessibility</button>
            </div>

            <label for="text-input" class="sr-only">Enter text to be read aloud</label>
            <textarea 
                id="text-input" 
                class="text-input-area" 
                placeholder="Type or paste text here to have it read aloud..."
                aria-describedby="text-hint"
            >Welcome to the text to speech reader! 

This tool uses your browser's built-in speech synthesis to read text aloud. You can:

‚Ä¢ Adjust the voice, speed, and pitch
‚Ä¢ Paste any text you want to hear
‚Ä¢ Use it to proofread your writing
‚Ä¢ Listen to content when reading is difficult

Try changing the settings above to find a voice that works best for you.</textarea>

            <div class="info-box">
                <h3>üí° Tips</h3>
                <p>
                    Try different voices to find one that's easiest to understand. 
                    Slower speeds can help with comprehension, while faster speeds 
                    work well for skimming content.
                </p>
            </div>
        </section>
    </main>

    <!-- Copilot Customization Guide -->
    <section class="copilot-section" aria-labelledby="copilot-heading">
        <h2 id="copilot-heading">ü§ñ Continue in VS Code with GitHub Copilot</h2>
        <p>Like this template? Open it in VS Code to customize it with Copilot!</p>
        
        <div class="step-box">
            <h3>Step 1: Clone the Repository</h3>
            <p>Open VS Code and press <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>P</kbd>, then type <strong>Git: Clone</strong></p>
            <div class="clone-box">
                <code class="clone-url" id="clone-url">https://github.com/MSLifN/prompt-to-prototype-challenge.git</code>
                <button class="copy-btn" onclick="copyCloneUrl()" aria-label="Copy clone URL">üìã Copy</button>
            </div>
        </div>
        
        <div class="step-box">
            <h3>Step 2: Open This Template</h3>
            <p>Navigate to: <code>templates/option-b/text-to-speech.html</code></p>
        </div>
        
        <div class="step-box">
            <h3>Step 3: Start Customizing</h3>
            <p>Press <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>I</kbd> to open Copilot Chat and try:</p>
            <div class="prompt-box">"Highlight each word as it's being spoken"</div>
            <div class="prompt-box">"Add keyboard shortcuts for play, pause, and stop"</div>
            <div class="prompt-box">"Save the user's voice and speed preferences"</div>
            <div class="prompt-box">"Add a button to read just the selected text"</div>
        </div>
        
        <p style="margin-top: 1rem;">üí° <strong>Tip:</strong> Select any code and press <kbd>Ctrl</kbd>+<kbd>I</kbd> for inline edits!</p>
    </section>

    <footer>
        <p>Built for the Prompt to Prototype Challenge</p>
    </footer>

    <script>
        /* ========================================
           JAVASCRIPT FUNCTIONALITY
           Customize with Copilot prompts like:
           - "Highlight words as they're spoken"
           - "Add keyboard shortcuts"
           - "Save voice preferences"
           ======================================== */

        // Check for speech synthesis support
        if (!('speechSynthesis' in window)) {
            document.getElementById('error-message').style.display = 'block';
        }

        const synth = window.speechSynthesis;
        let voices = [];
        let utterance = null;
        let isPaused = false;

        // Elements
        const playBtn = document.getElementById('play-btn');
        const replayBtn = document.getElementById('replay-btn');
        const buttonHint = document.getElementById('button-hint');
        const voiceSelect = document.getElementById('voice-select');
        const rateSlider = document.getElementById('rate-slider');
        const pitchSlider = document.getElementById('pitch-slider');
        const textInput = document.getElementById('text-input');
        const statusIndicator = document.getElementById('status-indicator');
        const statusText = document.getElementById('status-text');
        const playIcon = document.getElementById('play-icon');
        const playTextSpan = document.getElementById('play-text');
        const rateValue = document.getElementById('rate-value');
        const pitchValue = document.getElementById('pitch-value');
        const sampleButtons = document.querySelectorAll('.sample-btn');

        // Load voices
        function loadVoices() {
            voices = synth.getVoices();
            voiceSelect.innerHTML = '';

            if (voices.length === 0) {
                voiceSelect.innerHTML = '<option value="">No voices available</option>';
                return;
            }

            voices.forEach((voice, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${voice.name} (${voice.lang})`;
                if (voice.default) {
                    option.selected = true;
                }
                voiceSelect.appendChild(option);
            });
        }

        // Load voices when they become available
        loadVoices();
        if (synth.onvoiceschanged !== undefined) {
            synth.onvoiceschanged = loadVoices;
        }

        // Chrome workaround: warm up speech synthesis on first user interaction
        // This fixes the bug where the first speak() call is ignored
        let speechWarmedUp = false;
        function warmUpSpeech() {
            if (speechWarmedUp) return;
            speechWarmedUp = true;
            const warmUp = new SpeechSynthesisUtterance('');
            warmUp.volume = 0;
            synth.speak(warmUp);
            synth.cancel();
        }
        document.addEventListener('click', warmUpSpeech, { once: true });

        // Update status
        function updateStatus(status, isSpeaking = false) {
            statusText.textContent = status;
            statusIndicator.className = 'status-indicator';
            if (isSpeaking) {
                statusIndicator.classList.add('speaking');
            } else if (status === 'Ready') {
                statusIndicator.classList.add('ready');
            }
        }

        // Play/Pause button - handles play, pause, and resume
        playBtn.addEventListener('click', () => {
            // If paused, resume
            if (isPaused) {
                synth.resume();
                isPaused = false;
                updateButtonState('playing');
                updateStatus('Speaking...', true);
                return;
            }

            // If speaking, pause
            if (synth.speaking) {
                synth.pause();
                isPaused = true;
                updateButtonState('paused');
                updateStatus('Paused');
                return;
            }

            // Otherwise, start speaking
            const text = textInput.value.trim();
            if (!text) {
                updateStatus('Please enter some text');
                return;
            }

            utterance = new SpeechSynthesisUtterance(text);
            
            // Set voice
            const selectedVoice = voices[voiceSelect.value];
            if (selectedVoice) {
                utterance.voice = selectedVoice;
            }

            // Set rate and pitch
            utterance.rate = parseFloat(rateSlider.value);
            utterance.pitch = parseFloat(pitchSlider.value);

            // Events
            utterance.onstart = () => {
                updateButtonState('playing');
                updateStatus('Speaking...', true);
            };

            utterance.onend = () => {
                updateButtonState('ready');
                updateStatus('Finished');
                setTimeout(() => updateStatus('Ready'), 2000);
            };

            utterance.onerror = (e) => {
                updateButtonState('ready');
                // Ignore 'interrupted' and 'canceled' - these are normal when stopping/restarting
                if (e.error === 'interrupted' || e.error === 'canceled') {
                    updateStatus('Ready');
                } else {
                    updateStatus('Error: ' + e.error);
                }
            };

            synth.speak(utterance);
        });

        // Replay button - start over from the beginning
        replayBtn.addEventListener('click', () => {
            synth.cancel();
            isPaused = false;
            
            // Small delay then start again
            setTimeout(() => {
                playBtn.click();
            }, 100);
        });

        // Update button appearance based on state
        function updateButtonState(state) {
            playBtn.classList.remove('playing', 'paused');
            
            if (state === 'playing') {
                playBtn.classList.add('playing');
                playIcon.textContent = '‚è∏Ô∏è';
                playTextSpan.textContent = 'Pause';
                playBtn.setAttribute('aria-label', 'Pause speech');
                replayBtn.style.display = 'inline-flex';
                buttonHint.textContent = 'Press Pause to pause, Replay to start over';
            } else if (state === 'paused') {
                playBtn.classList.add('paused');
                playIcon.textContent = '‚ñ∂Ô∏è';
                playTextSpan.textContent = 'Resume';
                playBtn.setAttribute('aria-label', 'Resume speech');
                replayBtn.style.display = 'inline-flex';
                buttonHint.textContent = 'Press Resume to continue, Replay to start over';
            } else {
                playIcon.textContent = '‚ñ∂Ô∏è';
                playTextSpan.textContent = 'Play';
                playBtn.setAttribute('aria-label', 'Play speech');
                replayBtn.style.display = 'none';
                buttonHint.textContent = 'Press Play to start reading';
            }
        }

        // Rate slider
        rateSlider.addEventListener('input', () => {
            rateValue.textContent = rateSlider.value + 'x';
        });

        // Pitch slider
        pitchSlider.addEventListener('input', () => {
            pitchValue.textContent = pitchSlider.value;
        });

        // Find and select a voice by language code
        function selectVoiceByLang(langCode) {
            const voiceIndex = voices.findIndex(v => v.lang.toLowerCase().startsWith(langCode.toLowerCase()));
            if (voiceIndex !== -1) {
                voiceSelect.value = voiceIndex;
                return true;
            }
            return false;
        }

        // Sample text buttons
        sampleButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                textInput.value = btn.dataset.text;
                
                // If button has a language specified, try to switch voice
                if (btn.dataset.lang) {
                    if (selectVoiceByLang(btn.dataset.lang)) {
                        updateStatus('Switched to ' + voices[voiceSelect.value].name);
                    } else {
                        updateStatus('No ' + btn.dataset.lang + ' voice found');
                    }
                }
                
                textInput.focus();
            });
        });

        // Initialize status
        updateStatus('Ready');

        // Copy clone URL function
        function copyCloneUrl() {
            const url = document.getElementById('clone-url').textContent;
            navigator.clipboard.writeText(url).then(() => {
                const btn = document.querySelector('.copy-btn');
                btn.textContent = '‚úì Copied!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'üìã Copy';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }
    </script>
</body>
</html>
